{% extends "base.tmpl" %}
{% if year == '2014' %}
	{% set page_class = 'crag-stats' %}
{% else %}
	{% set page_class = 'visit-archive' %}
{% endif %}

{% block class %}
 class="{{page_class}}" 
{% endblock %}

{% block content %}
<h1>Crag Stats {{year}}</h1>
{% if weeksleft != '' %}
<i>{{weeksleft}} glorious weeks of summer left, get out there.</i>
{% endif %}
{% if year != '2014' %}
<table class="cragattendance flexitable">
        <tr>
                <th scope="row" class="visit" valign="middle">Years Available</th>
                {% for y in years %}
                <th>
                <td><a href="cragstats.php?year={{y.year}}">{{y.year}}</a></td>
                </th>
                {% endfor %}
                </tr>
</table>
{% endif %}
<h2>Top Attenders</h2>
<table class="flexitable">
	<tr>
		<th>Name</th>
		<th>Visits</th>
	</tr>
	{% for d in data %}
	<tr>
		<td data-th="Name">{{ d.firstname }} {{d.surname}}</td>
		<td data-th="Visits">{{ d.count }}</td>
	</tr>
	{% endfor %}
</table>

<h3>Top 3 Attended Crags</h3>
<table class="flexitable">
	<tr>
		<th>Date</th>
		<th>Crag</th>
		<th>Visits</th>
	</tr>
	{% for a in attendedcrag %}
	<tr>
		<td data-th="Date">{{ a.date|date ('d M Y') }}</td>
		<td data-th="Crag"><a href="cragdetail.php?cragvisit_id={{a.cragvisit_id}}">{{ a.venue }} {{a.area}}</a></td>
		<td data-th="Visits">{{ a.count }}</td>
	</tr>
	{% endfor %}
</table>
<h3>Rock Types</h3>
<table class="flexitable">
	<tr>
		<th>Rock</th>
		<th>Visits</th>
	</tr>
        {% for rt in rocktype %}
        <tr>
                <td>{{rt.rock}}</td>
                <td>{{rt.total}}</td>
        </tr>
        {% endfor %}
</table>
<h3>Rain Stop Play</h3>
<table class="flexitable">
	{% for r in rainedoff %}
	<tr>
		<td>{{r.count}}</td>
	</tr>
	{% endfor %}
</table>
{% endblock %}
